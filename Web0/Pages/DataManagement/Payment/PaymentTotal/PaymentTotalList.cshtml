@page
@model Web.Pages.DataManagement.Payment.PaymentTotal.PaymentTotalListModel
@{
    ViewData["Title"] = "Payment Total List";
}
@section Scripts{
    <environment include="Development">
        <script src="/js/paymentTotallist.js"></script>
    </environment>
    <environment exclude="Development">
        <script src="/js/paymentTotallist.min.js"></script>
    </environment>
}
    <div class="row justify-content-center" id="app">
        <div class="col">
            <button type="button" class="btn btn-primary mb-2" v-on:click="openPaymentDetailsModal()">Create New</button>
            <div class="col">
                <table class="table table-dark table-hover">
                    <thead>
                        <tr>
                            <th>Title</th>
                            <th>Priority</th>
                            <th>Business</th>
                            <th>Is Deposit</th>
                            <th>Price</th>
                            <th>Date</th>
                        </tr>
                        <tr>
                            <th>
                                <input class="form-control form-control-sm" type="text" placeholder="Name..." v-model="filter.Name" />
                            </th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        <template v-for="item in items">
                            <tr v-on:click="openPaymentDetailsModal(item)">
                                <td>{{item.Title}}</td>
                                <td>{{item.PaymentPriorityName}}</td>
                                <td>{{item.BusinessName}}</td>
                                <td>{{item.IsDeposit}}</td>
                                <td>{{item.Price}}</td>
                                <td>{{item.Date}}</td>
                            </tr>
                        </template>
                    </tbody>
                </table>
            </div>
        </div>
        <div id="PaymentTotalDetails" class="modal" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">
                            <span v-if="PaymentTotalDetails.PaymentId > 0">{{paymentTotaldetails.Title}}</span>
                            <span v-else>New Payment</span>
                        </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="row row-cols-1 g-2">
                            <div class=" col-8 mt-2">
                                <div is="input-group">
                                    <label>Title: </label>
                                    <input class="form-control form-control-sm" type="text" v-model="PaymentTotalDetails.Title" required />
                                </div>
                            </div>
                        </div>
                        <div class="row row-cols-2 g-2 mt-2">
                            <div class=" col-4 mt-2">
                                <div class="dropdown">
                                    <div is="input-group">
                                        <label>Business Name: </label>
                                        <input class="form-control form-control-sm" required type="text" autocomplete="off" data-toggle="dropdown" id="searchBusinesses" v-model="PaymentTotalDetails.BusinessName" v-on:keydown.enter.prevent="scanBusiness()" autofocus />
                                        <div class="dropdown-menu" ref="searchBusinesses">
                                            <div class="dropdown-item" v-show="searchResultBusinesses.length < 1 && !loadingAvailableBusinesses"><span>No results.</span></div>
                                            <div class="dropdown-item" v-show="loadingAvailableBusinesses"><span>Searching...</span></div>
                                            <div class="dropdown-item cursor-pointer" v-for="item in searchResultBusinesses" v-bind:key="item.Id" v-on:click="selectBusinesss(item)"><span>{{item.BusinessName}}</span></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-4 mt-2">
                                <div is="input-group">
                                    <label class="container-test">Is Deposit: </label>
                                    <div class="custom-control custom-switch">
                                        <input id="chkDeposit" type="checkbox" class="checkbox" v-model="PaymentTotalDetails.IsDeposit" />
                                        <label class="container" for="chkDeposit"><span v-show="PaymentTotalDetails.IsDeposit">Yes</span><span v-show="!PaymentTotalDetails.IsDeposit">No</span></label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row row-cols-3 g-3 mt-2">
                            <div class="col-4 mt-2">
                                <div>
                                    <label for="example-datepicker">Choose a date</label>
                                    <input class="form-control form-control-sm" type="text" id="datepickere" v-model="PaymentTotalDetails.Date" required />
                                </div>
                            </div>
                            <div class="col-4 mt-2">
                                <div is="input-group">
                                    <label>Price: </label>
                                    <input class="form-control form-control-sm" type="number" v-model="PaymentTotalDetails.Price" required />
                                </div>
                            </div>
                        </div>

                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="button" class="btn btn-primary" v-on:click="savePayment()">Save changes</button>
                    </div>
                </div>
            </div>
        </div>
    </div>