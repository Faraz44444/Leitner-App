var timeout=null,app=vueContext({el:"#app",components:{"c-checkbox":compCheckbox},data:function(){return{filter:{Name:"",OrderByDirection:2,OrderBy:"Date",ItemsPerPage:50,CurrentPage:1,TotalPages:150,Loading:!1},PaymentTotalDetails:{IsDeposit:!1},businessFilter:{},showItems:!1,items:[],searchResultBusinesses:[],loadingAvailableBusinesses:!1,businesses:[],showDetailsModal:!1}},watch:{"filter.Title":function(){this.filterChanged()},"filter.BusinessId":function(){this.filterChanged()},"filter.IsDeposit":function(){this.filterChanged()},"filter.PriceFrom":function(){this.filterChanged()},"filter.PriceTo":function(){this.filterChanged()},"filter.DateFrom":function(){this.filterChanged()},"filter.DateTo":function(){this.filterChanged()}},computed:{},methods:{getList:function(){if(!this.filter.Loading)return this.filter.Loading=!0,apiHandler.Get("paymentTotal",this.filter).then(n=>{this.items=n.Items,this.filter.TotalPages=n.TotalPages,this.filter.Loading=!1})},getBusinesses:function(){return apiHandler.Get("business/lookup",{}).then(n=>{this.businesses=n})},openPaymentDetailsModal:function(n){this.PaymentTotalDetails=n?Object.assign({},n):{IsPaidToPerson:!1,IsDeposit:!1};this.showDetailsModal=!0},savePayment:function(){if(formvalidation.Validate("PaymentTotalDetails"))return this.PaymentTotalDetails.PaymentId>0?apiHandler.Post("paymentTotal/"+this.PaymentTotalDetails.PaymentId,this.PaymentTotalDetails).then(()=>{this.getList(),this.showDetailsModal=!0}):apiHandler.Post("paymentTotal",this.PaymentTotalDetails).then(()=>{this.getList(),this.showDetailsModal=!0})},scanBusiness:function(){if(!(this.PaymentTotalDetails.BusinessName.length<1))return this.loadingAvailableBusinesses=!0,this.businessFilter.Name=this.PaymentTotalDetails.BusinessName,apiHandler.Get("business/lookup",this.businessFilter).then(n=>{this.searchResultBusinesses=n,$("#searchBusinesses").focus(),this.loadingAvailableBusinesses=!1,this.showItems=!0})},selectBusiness:function(n){this.PaymentTotalDetails.BusinessId=n.BusinessId;this.PaymentTotalDetails.BusinessName=n.Name},filterChanged:function(){this.filter.CurrentPage=1;this.getList()},filterChagnedDelayed:function(){clearTimeout(timeout);timeout=setTimeout(()=>{this.filterChanged()},200)},closeModal:function(){this.showDetailsModal=!1}},created:function(){this.getList();this.getBusinesses()},mounted:function(){$("#datepickere").datepicker()}});